<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Uklon — Перевірка розрахунків</title>

<style>
:root{
  --bg:#f2f4f7;--card:#fff;--accent:#0066ff;
  --green:#c8f5c2;--red:#ffd4d4;
  --good:#0c7a27;--bad:#a80000;--muted:#6b6b6b;
}
html,body{height:100%;margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;}
.wrap{max-width:620px;margin:12px auto;padding:14px;}
h1{text-align:center;margin:0 0 12px;font-size:20px;}
.card{background:#fff;border-radius:12px;padding:14px;box-shadow:0 6px 22px rgba(0,0,0,.06);}
label{display:block;color:var(--muted);font-size:14px;margin:8px 0 6px;}
input{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ee;font-size:16px;}
.btn{width:100%;margin-top:12px;padding:12px;border:0;border-radius:10px;background:var(--accent);color:#fff;font-weight:700;font-size:16px;cursor:pointer;}
.results{margin-top:14px;display:grid;gap:12px;}
.panel{background:#fff;border-radius:10px;padding:12px;border:1px solid #e9eef8;}
.panel h3{margin:0 0 8px;}
.line{display:flex;justify-content:space-between;padding:6px 0;border-top:1px dashed #f0f4ff;}
.line:first-child{border-top:0}
.val{font-weight:700;}
.diff{padding:6px 10px;border-radius:8px;font-weight:700;min-width:90px;text-align:center;}
textarea{width:100%;height:110px;margin-top:8px;border-radius:8px;padding:8px;border:1px solid #ddd;font-size:14px;}
.small-row{display:flex;gap:8px;margin-top:8px;}
.small-btn{flex:1;padding:8px;border-radius:8px;border:0;background:#efefef;cursor:pointer;}
.note{font-size:13px;color:var(--muted);margin-top:8px;}
</style>
</head>

<body>
<div class="wrap">
<h1>Перевірка розрахунків Uklon</h1>

<div class="card">
  <label>Фактична сума, грн</label>
  <input id="actual" type="number" step="0.01">

  <label>Пробіг, км</label>
  <input id="distance" type="number" step="0.01">

  <label>Коефіцієнт</label>
  <input id="coef" type="number" step="0.01" value="1">

  <button id="calcBtn" class="btn">Розрахувати</button>
  <div id="status" class="note"></div>
</div>

<div class="results">

<div class="panel">
<h3>Стандарт</h3>
<div class="line"><div>Розрахунок</div><div class="val" id="stdCalc">—</div></div>
<div class="line"><div>Різниця</div><div class="diff" id="stdDiff">—</div></div>
<textarea id="stdMsg" readonly></textarea>
<div class="small-row"><button class="small-btn" onclick="copy('stdMsg')">Копіювати</button></div>
</div>

<div class="panel">
<h3>Комфорт</h3>
<div class="line"><div>Розрахунок</div><div class="val" id="cfCalc">—</div></div>
<div class="line"><div>Різниця</div><div class="diff" id="cfDiff">—</div></div>
<textarea id="cfMsg" readonly></textarea>
<div class="small-row"><button class="small-btn" onclick="copy('cfMsg')">Копіювати</button></div>
</div>

<div class="panel">
<h3>Бізнес</h3>
<div class="line"><div>Розрахунок</div><div class="val" id="bizCalc">—</div></div>
<div class="line"><div>Різниця</div><div class="diff" id="bizDiff">—</div></div>
<textarea id="bizMsg" readonly></textarea>
<div class="small-row"><button class="small-btn" onclick="copy('bizMsg')">Копіювати</button></div>
</div>

</div>
</div>

<script>
// fallback tariffs
const STD={name:"Стандарт",minKm:1.9,base:100,perKm:17.6};
const CFM={name:"Комфорт",minKm:2.1,base:115,perKm:20.4};
const BIZ={name:"Бізнес",minKm:1.6,base:140,perKm:24.2};

function calcFare(km,t){return km<=t.minKm?t.base:t.base+(km-t.minKm)*t.perKm;}
function fmt(x){return x.toFixed(2)+" грн";}
function setDiff(el,val){
  el.textContent=fmt(val);
  el.style.background=val>0?"var(--green)":val<0?"var(--red)":"";
  el.style.color=val>0?"var(--good)":val<0?"var(--bad)":"";
}

// === КОРОТКОЕ СООБЩЕНИЕ С ДОНАЧИСЛЕНИЕМ ===
function buildMsg(t,km,k,total,actual){
  const diff=total-actual;
  if(diff<=0) return "";
  return `Прошу перерахунок поїздки (${t.name}).
Пробіг: ${km} км, коеф.: ${k}.
(${t.base}+(${km}-${t.minKm})×${t.perKm.toFixed(2)})×${k}=${total.toFixed(2)} грн.
В замовленні: ${actual.toFixed(2)} грн.
Донарахувати: ${diff.toFixed(2)} грн.`;
}

document.getElementById("calcBtn").onclick=()=>{
  const actual=+actualInput.value;
  const km=+distance.value;
  const k=+coef.value;
  if(!actual||!km||!k)return alert("Введіть усі значення");

  const s=calcFare(km,STD)*k;
  const c=calcFare(km,CFM)*k;
  const b=calcFare(km,BIZ)*k;

  stdCalc.textContent=fmt(s);
  cfCalc.textContent=fmt(c);
  bizCalc.textContent=fmt(b);

  setDiff(stdDiff,actual-s);
  setDiff(cfDiff,actual-c);
  setDiff(bizDiff,actual-b);

  stdMsg.value=buildMsg(STD,km,k,s,actual);
  cfMsg.value=buildMsg(CFM,km,k,c,actual);
  bizMsg.value=buildMsg(BIZ,km,k,b,actual);
};

function copy(id){
  const t=document.getElementById(id);
  if(!t.value)return alert("Немає тексту");
  navigator.clipboard.writeText(t.value);
  alert("Скопійовано");
}
</script>
</body>
</html>
